<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> ::File I/O </title>
</head>
<body>
    <script>
        // function writeFile(name, msg){
        //     var defaultpath = "C:"; // 기록하고자 하는 경로. ex) C:\\Program Files\\logs
        //     var fileObject = new ActiveXObject("Scripting.FileSystemObject");
        //     var fullpath = defaultpath+"\\"+name;   // 해당 경로에 name의 파일

        function writeFile(){
            alert('start');
            var defaultpath = "C:"; // 기록하고자 하는 경로. ex) C:\\Program Files\\logs
            var fileObject = new ActiveXObject("Scripting.FileSystemObject");
            var fullpath = defaultpath+"\\"+"Userlist.txt";   // 해당 경로에 name의 파일

            // 파일이 생성되어있지 않으면 새로 만들고 기록
            if(!fileObject.FileExists(fullpath)){
                var fWrite = fileObject.CreateTextFile(fullpath,false);
                fWrite.write("msg");
                fWrite.close();
            }

            else{
            // 파일이 이미 생성되어 있으면 appending 모드로 파일 열고 기록
                var fWrite = fileObject.OpenTextFile(fullpath, 8);
                fWrite.write("msg");
                fWrite.close();
            }
        }
    </script>



    <input type="button" value="Create File" onclick="writeFile()">
    <br><br>
    <textarea name="text" id="Input" cols="40" rows="6">
        이곳에 글을 입력하세요.
    </textarea><br><br><br><br>


    <input type="button" value="Show File" onclick="showFile()">
    <br><br>
    <textarea name="text" id="Output" cols="40" rows="6">
        저장된 글을 보기 위한 곳입니다.
    </textarea>
    


    
</body>
</html>